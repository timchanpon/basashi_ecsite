{% extends 'base.html' %}

{% block title %}ユーザー情報{% endblock %}
{% block head %}
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
{% endblock %}

{% block contents %}
<h4>{{ object.username }}</h4>

<div id="json-test">
  <select v-model="pref">
    <option v-for="address in addresses.data" :value="address.id">{[ address.pref ]}</option>
  </select>
  <select>
    <option v-for="item in city">{[ item.name ]}</option>
  </select>
</div>
{% endblock %}

{% block script %}
<script>
  new Vue({
    el: '#json-test',
    data: {
      addresses: null,
      pref: null,
      city: null,
    },
    watch: {
      pref: function() {
        if (this.pref) {
          this.city = this.addresses.data[this.pref-1]["city"]
        } else {
          this.city = null
        }
      },
    },
    mounted: function() {
      axios.get("/static/json/addresses.json").then(response => (this.addresses = response))
    },
    delimiters: ['{[', ']}'],
  })
</script>
{% endblock %}
